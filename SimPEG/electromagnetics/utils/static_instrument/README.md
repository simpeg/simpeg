This code was contributed by Emerald Geomodelling
